<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Task 5 - 21BCE5841</title>
    <link rel="stylesheet" href="/style.css" />
    <style>
      table.regid {
        border-collapse: collapse;
        width: 100%;
      }
      table.regid th,
      table.regid td {
        text-align: left;
        padding: 8px;
        border: black 1px solid;
      }
      table.regid tr:nth-child(even) {
        background-color: #f2f2f2;
      }
    </style>

  </head>
  <body>

    <div class="root">
      <h1>Task 5</h1>

      <table class="regid">
        <tr>
          <td>Registration number</td>
          <td>21BCE5841</td>
        </tr>
        <tr>
          <td>Name</td>
          <td>Srevin Saju</td>
        </tr>
      </table>
      <br />


    
        
      <div>
        <table border="0" cellspacing="10">
            <tr>
                <td style="float:right;">Name:</td>
                <td>
                    <input type="text" id="name" >
                    <span class="name-invalid" style="margin-left: 20px;"></span>
                </td>
            </tr>
            <tr>
                <td style="float:right;">Email:</td>
                <td>
                    <input type="email" id="email" >
                    <span class="email-invalid" style="margin-left: 20px;"></span>
                </td>
            </tr>
            <tr>
                <td style="float:right;">Website:</td>
                <td>
                    <input type="text" id="website" >
                    <span class="url-invalid" style="margin-left: 20px;"></span>
                </td>
            </tr>
            <tr>
                <td style="float:right;">Message:</td>
                <td>
                    <textarea name="message" id="message" cols="25" rows="5" ></textarea>
                    <span class="message-invalid" style="margin-left: 20px; position:relative; top:-70px;"></span>
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <button type="submit">Submit</button>
                </td>
            </tr>
        </table>
    </div>
    </div>

    <script>
      const isValidUrl = (urlString) => {
          const inputElement = document.createElement('input');
          inputElement.type = 'url';
          inputElement.value = urlString;
          return inputElement.checkValidity();
      };

      const validateForm = () => {
          let flag = 0;
          const validRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;
          const elements = {
              name: { element: document.getElementById('name'), error: '.name-invalid', message: 'This field is required' },
              email: { element: document.getElementById('email'), error: '.email-invalid', message: 'A valid email address is required' },
              website: { element: document.querySelector("#website"), error: '.url-invalid', message: 'A valid URL is required' },
              message: { element: document.getElementById('message'), error: '.message-invalid', message: 'This field is required' }
          };

          for (const key in elements) {
              const element = elements[key];
              const inputValue = element.element.value.trim();
              const errorElement = document.querySelector(element.error);
              
              if (inputValue === "") {
                  flag = 1;
                  element.element.style.borderColor = "red";
                  element.element.style.borderWidth = "3px";
                  errorElement.innerText = element.message;
                  errorElement.style.color = "red";
              } else if (key === 'email' && !inputValue.match(validRegex)) {
                  flag = 1;
                  element.element.style.borderColor = "red";
                  element.element.style.borderWidth = "3px";
                  errorElement.innerText = element.message;
                  errorElement.style.color = "red";
              } else if (key === 'website' && (inputValue === "" || !isValidUrl(inputValue))) {
                  flag = 1;
                  element.element.style.borderColor = "red";
                  element.element.style.borderWidth = "3px";
                  errorElement.innerText = element.message;
                  errorElement.style.color = "red";
              }
          }

          if (flag === 0) {
              window.location.href = elements.website.element.value.trim();
          }
      };

      document.querySelector("button").addEventListener("click", validateForm);

      
    </script>

  </body>
</html>
